import{v as R,y as F,a as l,t as e,B as A}from"./chunk-ZYFC6VSF-CcTFIW6Y.js";import{g as C,o as B,u as b}from"./index-35c79a8a-B373Vm6L.js";import"./index.esm2017-T8jfeyBt.js";import{g as M,u as k,r as V}from"./index.esm2017-BgJZ7Iac.js";import{u as $,a as O}from"./react-redux-DItQxzwd.js";import{g as T,r as q,u as G,a as H}from"./index.esm2017-Ck1t7IkA.js";import{a as J}from"./user-slice-CHAln-Bf.js";import{B as v}from"./Button-DRBTarQj.js";import{I as w}from"./Input-D8yPxS1O.js";import"./redux-toolkit.modern-lSMJCofG.js";const re=R(function(){const n=C(),N=M(),y=T(),U=F(),S=$(),t=O(s=>s.user),[E,c]=l.useState(!1),[p,m]=l.useState(null),[i,f]=l.useState(!1),[L,P]=l.useState("Profile Pic");B(n,s=>{if(s){const r=U.pathname.split("/").pop();c(s.uid===r),m(s.uid)}else c(!1),m(null)}),l.useEffect(()=>()=>{u()},[]);function D(){f(s=>!s)}function u(){i&&f(!1)}function z(s){s.preventDefault();const r=new FormData(s.target),o=Object.fromEntries(r);console.log("editing user:",o);const g="users/users/"+p+"/public";k(V(N),{[g+"/username"]:o["user-profile-username"],[g+"/statusMessage"]:o["user-profile-status-message"]}).catch(a=>{console.log("error updating user's information"),console.log(a.message)}),b(n.currentUser,{displayName:o["user-profile-username"]}).catch(a=>{console.log("error updating the user's display name"),console.log(a.message)});const x=o["user-pfp"];if(x.size>0){const a=q(y,`users/${p}/pfp`);G(a,x).then(h=>{H(a).then(j=>{b(n.currentUser,{photoURL:j}).then(()=>{S(J.updatePfpURL(j)),u()}).catch(I=>{console.log("error updating the user's pfp"),console.log(I.message)})})}).catch(h=>{console.log("error uploading pfp image"),console.log(h.message)})}u()}let d=e.jsx("div",{className:"w-full flex flex-col gap-30",children:e.jsxs("div",{className:"w-[60vw] flex flex-row gap-10 items-center",children:[t.pfpURL?e.jsx("img",{src:t.pfpURL,className:"size-[150px] xl:size-[200px] object-cover object-center rounded-xl"}):e.jsx("div",{className:"flex size-[150px] xl:size-[200px] bg-white text-neutral-500 justify-center items-center text-center break-all overflow-hidden p-3 rounded-xl",children:"Empty pfp"}),e.jsxs("div",{className:"grow flex flex-col gap-2",children:[e.jsx("h2",{children:t.username||"No username has been set"}),e.jsx("div",{className:"bg-white px-3 py-1 rounded-md",children:e.jsx("p",{children:t.statusMessage||"No status message has been set"})})]})]})});return i&&(d=e.jsx(A,{onSubmit:s=>z(s),children:e.jsxs("div",{className:"w-full flex flex-col gap-30",children:[e.jsxs("div",{className:"w-[60vw] flex flex-row gap-10 items-center",children:[e.jsx("input",{type:"file",name:"user-pfp",id:"user-pfp",className:"inputFile",onChange:s=>{let r=s.target.value.split("\\").pop();P(r)}}),e.jsx("label",{htmlFor:"user-pfp",className:"flex size-[150px] xl:size-[200px] bg-white text-neutral-500 justify-center items-center text-center break-all overflow-hidden p-3 rounded-xl hover:bg-neutral-50 focus:ring",children:L}),e.jsxs("div",{className:"grow flex flex-col gap-2",children:[e.jsx(w,{id:"user-profile-username",name:"user-profile-username",type:"text",className:"text-[2rem] cursor-pointer hover:bg-neutral-50",minLength:1,maxLength:12,pattern:"[ -~]+",placeholder:"Username",defaultValue:t.username}),e.jsx(w,{id:"user-profile-status-message",name:"user-profile-status-message",type:"text",className:"py-1 cursor-pointer hover:bg-neutral-50",minLength:0,maxLength:50,pattern:"[ -~]+",placeholder:"Status Message",defaultValue:t.statusMessage})]})]}),e.jsx(v,{type:"submit",children:"Save"})]})})),e.jsxs("div",{className:"p-32 xl:px-[20vw]",children:[e.jsxs("div",{className:"flex flex-row justify-between items-center mb-10",children:[e.jsx("h1",{children:"User Profile"}),E&&e.jsx(v,{onClick:D,type:"button",children:i?"Cancel":"Edit"})]}),d]})});export{re as default};
